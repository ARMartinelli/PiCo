language: cpp

dist: trusty
sudo: required

addons:
  sonarcloud:
    organization: "falkenrambaldi-github" # the key of the org you chose at step #3
    token:
      secure: "ed0cbUUy7oZM7ejdC2xlKxSXeNIY+wgE5vNi0ITSYF9dDwL9eHvb1vQy5Iy4VO7uDTCffRGjF/Nnp/0qvYnPF1pijpd0L5NyCFG6MTT6C2EV+kyS7MuiF1JazMrFDaFuwUXLQ8hUHK4txtRtiD6nw525AFJsEHTJG9/cWUoZNLMkvXin1v7tkd5DQvFCD4ArrtwaqLliNzCC6bO9JT2BLrs9Om1qBNMk+r9C0Ua61usV2DChFfayMC0jU38mLCLRlyuotDkoX3h8jrvKaOF/Za64bdtirUT+ohEwAulrbmOlQt5uXAokulZOCReI+0rtVTJKa7/4wgQR+54yafHoobtj8SZ6QzNCUs7YbFICUmHpOdgohCGMOhWn3elh59OQNCwIpzqdw7xpMqf4YT1uKzWqH/8IbbY189DeBBJIrE1MVQYxgRXS9IpE7m3J49JgrfR62JgkRb+wy+Jx43JcLeZRD2SspJg5cSkqaf2lDDtj1U4n+fH1WO+CpM3M0KX3EAO9ZZxKdjQ2/pcqRN485EnmXSg/PJT4RrbcK5VYcRsAi/SP1fZjEeLPWMdg68jT6qyp6IxNxwdlTGZLH201sJ+Di2SS1LrtvJaMPfGbObF8U5cU6HRGF2pwo4UOOnjFaDa3v8rLr7FDcb++NHfBtxLRhoj8kDpOm9ET9titXuI="


cache:
  directories:
  - '$HOME/.sonar/cache'

matrix:
  include:
    - os: osx
      osx_image: xcode10.1
      env:
        - MATRIX_EVAL="CC=clang && CXX=clang++"

    - os: linux
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-5

      env:
        - MATRIX_EVAL="CC=gcc-5 && CXX=g++-5"
    - os: linux
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-6

      env:
        - MATRIX_EVAL="CC=gcc-6 && CXX=g++-6"
    - os: linux
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-7

      env:
        - MATRIX_EVAL="CC=gcc-7 && CXX=g++-7"
    - os: linux
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
            - llvm-toolchain-trusty-5.0
          packages:
            - g++-7
            - clang-5.0
      env:
        - MATRIX_EVAL="CC=clang-5.0 && CXX=clang++-5.0"

before_install:
        - eval "${MATRIX_EVAL}"
install:
        - git clone --single-branch https://github.com/fastflow/fastflow.git
        - ln -s fastflow/ff ff
script:
        - mkdir build && cd build
        - cmake ..
        - make
        - ctest
        - sonar-scanner
